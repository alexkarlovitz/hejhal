\documentclass[]{article}

\usepackage[margin=1.0in]{geometry}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage{graphicx}
\usepackage{amssymb}

\usepackage{mathtools}

\PassOptionsToPackage{hyperfootnotes=false}{hyperref}
\usepackage{hyperref}

%opening
\title{Hejhal's Algorithm in $\mathbb{H}^3$}
\author{Alex Karlovitz}
\date{}

\begin{document}
	
	\maketitle

In this document, we describe Hejhal's algorithm as it applies to hyperbolic 3-space.
It is essentially the same as in 2-space; the differences occur only in the details of discrete groups acting on $\mathbb{H}^3$.
We begin with some background regarding hyperbolic 3-space, then we move on to Maass forms in this context.
After that, we will be ready to discuss the algorithm.

\section*{Preliminaries on $\mathbb{H}^3$}

By \textit{hyperbolic 3-space} (or $\mathbb{H}^3$), we mean the unique simply-connected Riemannian 3-manifold with constant sectional curvature -1.
There are various models of this space, but for now we will work with the upper half-space model.
Let the set $U^3$ consist of the subset of $\mathbb{R}^3$ with positive third component
$$
U^3 = \{ (x_1, x_2, y) \in \mathbb{R}^3 : y > 0 \}
$$
We endow $U^3$ with the metric
$$
ds^2 = \frac{dx_1^2 + dx_2^2 + dy^2}{y^2}
$$
It is well known that $(U^3, ds^2)$ is then isometric to $\mathbb{H}^3$.
Moreover, we note that $\mathbb{H}^3$ can be identified with the Hamiltonian quaternions whose $k$-term is 0.
That is, we take the subalgebra of
$$
\{ x_1 + x_2i + x_3j + x_4k : x_1, x_2, x_3, x_4 \in \mathbb{R}, i^2 = j^2 = k^2 = ijk = -1 \}
$$
whose elements have $x_3 > 0$ and $x_4 = 0$.
Replacing the name ``$x_3$'' with ``$y$,'' we evidently have the same set $U^3$.

\subsection*{M\"obius Transformations in 3-space}

Recall that $\text{SL}(2, \mathbb{R})$ acts on the upper half plane $\mathbb{H}^2$ via M\"obius transformations.
It is well known that these give all orientation-preserving isometries of hyperbolic 2-space.
In a similar fashion, $\text{Isom}^+(\mathbb{H}^3) \cong \text{PSL}(2, \mathbb{C})$.
Specifically, a given matrix acts on $\mathbb{H}^3$ via M\"obius transformations, where we interpret division as multiplication by the inverse in the quaternions:
$$
\begin{pmatrix}
\alpha & \beta \\
\gamma & \delta
\end{pmatrix}(z) =
(\alpha z + \beta)(\gamma z + \delta)^{-1}
$$
($z^{-1} = \bar{z}/|z|^2$).
If interested, one can find proofs of these facts online. (See, e.g., \href{http://www.maths.qmul.ac.uk/~sb/LTCCcourse/Holodyn2013notes_week3.pdf}{Holodyn 2013} for an outline).

To get a geometric feel for these transformations, it is instructive to consider the \textit{frame bundle} F$\mathbb{H}^3$ of hyperbolic space.
This is the set
$$
\text{F}\mathbb{H}^3 = \{ (z, v, w) \in U^3 \times \mathbb{R}^3 \times \mathbb{R}^3 : ||(v, w)||_z = 1, ~ v \perp w \}
$$
where the norm $||(\cdot, \cdot)||_z$ is derived from the hyperbolic metric.
\textbf{(ASK AK FOR DETAILS HERE)!}
One can show that $\text{PSL}(2, \mathbb{C})$ acts simply transitively on F$\mathbb{H}^3$, where the action is by
$$
g(z, v, w) = (g(z), \textbf{?}, \textbf{?}) ~~~~~ \text{Maybe}~ (g(z), g'(z)v, g'(z)w)\text{? But need to think about derivative...}
$$
\textbf{(ASK AK FOR DETAILS HERE)!}
Thus, we can identify $\text{PSL}(2, \mathbb{C})$ with F$\mathbb{H}^3$ by associating a matrix $g$ with the point $g(j, j, 1)$.
Intuitively, one thinks of $z$ as the base point in upper half-space, $v$ as a tangent vector pointing in the direction of a geodesic, and $w$ as a ``frame vector'' which is perpendicular to the tangent vector.
(Recall that geodesics in $\mathbb{H}^3$ are semicircles or vertical lines which are perpendicular to the $x_1x_2$-plane).

We now describe the geometry of the matrix action by describing how it moves the frame bundle.
First, recall the decomposition $\text{SL}(2, \mathbb{C}) = NAK$ where
$$
N = \left\{ 
\begin{pmatrix}
1 & u \\
~ & 1
\end{pmatrix} : u \in \mathbb{C}
\right\} ~~~~~
A = \left\{
\begin{pmatrix}
e^{t/2} & ~ \\
~ & e^{-t/2}
\end{pmatrix} : t \in \mathbb{R}
\right\} ~~~~~
K = M\text{SO}(2)M
$$
where $\text{SO}(2)$ is the special orthogonal group and
$$
M = \left\{
\begin{pmatrix}
e^{i\theta} & ~ \\
~ & e^{-i\theta}
\end{pmatrix} : \theta \in \mathbb{R}
\right\}
$$
Matrices from these three groups move the frame bundle in fairly simple ways.
\begin{itemize}
	\item A matrix in $N$ moves the point $(j, j, 1)$ to $(j + u, j, 1)$; that is, the base point is shifted by Re$(u)$ in the $x_1$ direction and by Im$(u)$ in the $x_2$ direction.
	In other words, $N$ moves points along the horosphere determined by the base point (horospheres in $\mathbb{H}^3$ are planes parallel to the $x_1x_2$-plane or spheres which are tangent to the $x_1x_2$-plane); the real part of $u$ determines the translation in the direction of the tangent vector, and the imaginary part determines the translation in the direction of the frame vector.
	\item Just as in hyperbolic 2-space, a matrix in $A$ moves points along geodesics at unit speed for time $t$.
	\item Matrices in $K$ fix the base point $j \in \mathbb{H}^3$ in $(j, j, 1)$ but can rotate the frame bundle to any position. Specifically, matrices in $M$ rotate the frame vector while leaving the tangent vector fixed, while matrices in SO(2) have the opposite effect.
\end{itemize}

\subsection*{The Action of Hyperbolic Elements}

We will be interested in subgroups $\Gamma \subseteq \text{PSL}(2, \mathbb{C})$ which act discontinuously on $\mathbb{H}^3$.
Such subgroups always contain \textit{loxodromic} elements (diagonalizable matrices with eigenvalues of norm not equal to $\pm1$).
In the special case where a loxodromic element has \textit{real} eigenvalues, we call the matrix \textit{hyperbolic}.
Now suppose $\Gamma$ contains a hyperbolic element $\gamma$, and let $g \in \text{SL}(2, \mathbb{C})$ diagonalize it.
Specifically, suppose
$$
g\gamma g^{-1} =
\begin{pmatrix}
\sqrt{\kappa} & ~ \\
~ & \sqrt{\kappa}^{-1}
\end{pmatrix}
$$
where $\kappa > 1$. Then there exists a fundamental domain for $g\Gamma g^{-1}/\mathbb{H}^3$ contained in
$$
F = \{ z \in \mathbb{H}^3 : 1 \leq ||z||_2 \leq \kappa \}
$$
since $g\gamma g^{-1}$ acts on the base points by scaling by $\kappa$.
When the group $\Gamma\backslash\mathbb{H}^3$ has infinite covolume, then such a fundamental domain must contain a positive-measure set in the $x_1x_2$-plane as part of its boundary.
We call these fundamental domains \textit{flare domains}, as the definition follows the same lines as those in $\mathbb{H}^2$.

\section*{Fourier Expansion in a Flare}

In the upper-half plane model of $\mathbb{H}^3$, the Laplacian is
$$
\Delta = -y^2\left( \frac{\partial^2}{\partial x_1^2} + \frac{\partial^2}{\partial x_2^2} + \frac{\partial^2}{\partial y^2} \right) + y\frac{\partial}{\partial y}
$$
To make use of the invariance under $z \mapsto \kappa z$ in a flare domain, we will utilize spherical coordinates.
Specifically, we write $(r, \theta, \varphi)$ for a point in $\mathbb{H}^3$, where $r$ is the (Euclidean) distance from the origin, $\theta$ is the angle of the projection onto the $x_1x_2$-plane measured counterclockwise from the positive $x_1$-axis, and $\varphi$ is the smaller angle measured off of the positive $y$-axis.
Note that since we are working with the upper-half plane model, $\varphi \in [0, \pi/2]$ with $\varphi = \pi/2$ indicating a point on the boundary.
In these coordinates, one can check that the Laplacian becomes
$$
\Delta = -\left(r^2\cos^2\varphi\frac{\partial^2}{\partial r^2} + \cot^2\varphi\frac{\partial^2}{\partial \theta^2} + \cos^2\varphi\frac{\partial^2}{\partial \varphi^2} + r\cos^2\varphi\frac{\partial}{\partial r} + \cot\varphi\frac{\partial}{\partial \varphi}\right)
$$

Next, suppose $f$ is a Maass form for $\Gamma\backslash\mathbb{H}^3$, where $\Gamma \subseteq \text{PSL}(2, \mathbb{C})$ contains the diagonal matrix whose action is $z \mapsto \kappa z$.
Then $f$ has a logarithmic Fourier expansion in $r$.
$$
f(r, \theta, \varphi) =
\sum_{n \in \mathbb{Z}}a_n(\theta, \varphi)e\left(n\frac{\log r}{\log\kappa}\right)
$$
Since $f$ is an eigenfunction of the Laplacian, we have $\Delta f = \lambda f$ for some $\lambda \in \mathbb{C}$.
This results in the following PDE for $a_n(\theta, \varphi)$
$$
\cot^2\varphi\frac{\partial^2}{d\theta^2}a_n(\theta, \varphi) + \cos^2\varphi\frac{\partial^2}{\partial\varphi^2}a_n(\theta, \varphi) + \cot\varphi\frac{\partial}{\partial\varphi}a_n(\theta, \varphi) + \left( \lambda - \frac{4\pi^2n^2}{\log^2\kappa}\cos^2\varphi \right)a_n(\theta, \varphi) = 0
$$
Let us fix $n$ for the moment and write $a_n(\theta, \varphi) = f(\theta)g(\varphi)$.
This separation of variables results in the two ODEs
$$
\begin{cases}
\frac{f''(\theta)}{f(\theta)} = C \\
\sin^2\varphi\frac{g''(\varphi)}{g(\varphi)} + \tan\varphi\frac{g'(\varphi)}{g(\varphi)} + \lambda\tan^2\varphi - \frac{4\pi^2n^2}{\log^2\kappa}\sin^2\varphi = C
\end{cases}
$$
where $C \in \mathbb{R}$ is some constant shared between the two equations.
Solving the equation in $\theta$, and using the fact that $a_n(\theta, \varphi)$ is invariant under $\theta \mapsto \theta + 2\pi$, one finds that
$$
f(\theta) = e^{im\theta}
$$
for some $m \in \mathbb{Z}$.
Note that this restricts the constant to $C = -m^2$.
\\

Alternatively, one could simply note that the invariance under $\theta \mapsto \theta + 2\pi$ implies $a_n(\theta, \varphi)$ has a Fourier expansion in $\theta$.
This lets us assume
$$
f(r, \theta, \varphi) = \sum_{m, n \in \mathbb{Z}}g_{m, n}(\varphi)e^{im\theta}e\left(n\frac{\log r}{\log\kappa}\right)
$$
Applying the differential equation $\Delta f + \lambda f = 0$, we can reduce to an ODE in $g_{m, n}(\theta)$ for each pair of $m, n \in \mathbb{Z}$.
Fixing $m$ and $n$ for the moment, we write $g = g_{m,n}$.
The ODE is then
\begin{equation}\label{gODE}
\sin^2\varphi g''(\varphi) + \tan\varphi g'(\varphi) + \left(m^2 + \lambda\tan^2\varphi - \frac{4\pi^2n^2}{\log^2\kappa}\sin^2\varphi\right)g(\varphi) = 0
\end{equation}
which is the same as we found using separation of variables above.
\\

In both methods, we are left trying to find a solution to (\ref{gODE}).
This can be converted to a hypergeometric differential equation as follows.
First, make the change of variables
$$
h(\cos^2\varphi) = \sin\varphi g(\varphi) ~~~ x = \cos^2\varphi
$$
Then equation (\ref{gODE}) reduces to
$$
4x^2(x - 1)^2h''(x) + \left( x^2 - \frac{4\pi^2n^2}{\log^2\kappa}x(1 - x) + m^2x + \lambda(1 - x) \right)h(x) = 0
$$
Some straightforward calculations show that $x = 0, 1, \infty$ are the three regular singular points of this differential equation.
Thus, the ODE has a hypergeometric function as a solution.

\end{document}